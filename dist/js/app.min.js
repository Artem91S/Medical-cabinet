(()=>{"use strict";var e={d:(t,a)=>{for(var s in a)e.o(a,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:a[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{o:()=>M});class t{constructor(e,t,a){this.title="",this.cardiologist=e,this.dentist=t,this.therapeutic=a}createModal(){let e=`\n    <section class="modal">\n    <div class="modal__content">\n        <div class="modal__content__close-btn">&times;</div>\n              <h3 class="modal__content__title">Створити Візит</h3>  \n              <select name="doctor" class="modal__content__choose__doctor">\n                <option name="doctor" >Усі</option>\n                <option name="doctor" value="Кардіолог">${this.cardiologist}</option>\n                <option name="doctor" value="Стоматолог">${this.dentist}</option>\n                <option name="doctor" value="Терапевт">${this.therapeutic}</option>   \n             </select>  \n                <form class="modal-creating__form form flex__forma">            \n                  \n                </form>\n        <button class="btn btn__send__visit">Відправити</button>\n    </div>\n    </section>\n    `;document.body.insertAdjacentHTML("beforeend",e)}closeModal(){document.querySelector(".modal").remove()}clickCloseModal(){let e=document.querySelector(".modal"),t=document.querySelector(".modal__content__close-btn");e.addEventListener("click",(a=>{a.target!==e&&a.target!==t||this.closeModal()}))}createModalEnter(e){let t=`\n        <section class="modal">\n        <div class="modal__content">\n        <h2 class="modal__content__title">${e}</h2>\n        <div class="modal__content__close-btn">&times;</div>\n            <label for='email'>Email:</label>\n            <input type='email' name='email' class="modal__email"/>\n            <label for='password'>Password:</label>\n            <input type='password' name='password' class="modal__password"/>\n            <button class="modal__content__registration-btn btn btn--red">Увійти</button>\n            </div>\n        </section>\n         `;document.body.insertAdjacentHTML("beforeend",t)}}class a{constructor(e,t,a,s,n){this.fullName=e,this.visitType=t,this.visitDescription=a,this.visitUrgency=s,this.visitStatus=n}createForma(e){let t=`\n                <label for="fullName"class="visit__labels">${this.fullName}:</label>\n                     <input name="fullName" type="text" value="" class="border input--size">\n               <label for="visitType" class="visit__labels">${this.visitType}:</label>\n                     <input name="visitType" type="text" value="" class="border input--size">\n                <label for="visitDescription" class="visit__labels">${this.visitDescription}:</label>\n                     <textarea cols="10" class="border"  name="visitDescription" value="" rows="5"></textarea>\n                <label for="impotent" class="visit__labels">${this.visitStatus}:</label>\n                <select name="visitStatus" class="input--size">\n                    <option name="visitStatus" value="Вікрита">Вікрита</option>\n                    <option name="visitStatus"value="Закрита">Закрита</option>\n                </select>\n                <label for="impotent" class="visit__labels">${this.visitUrgency}:</label>\n                <select name="visitUrgency" class="input--size">\n                    <option value="Невідкладна">Невідкладна</option>\n                    <option value="Пріоритетна">Пріоритетна</option>\n                    <option value="Звичайна">Звичайна</option>                \n              </select>`;e.insertAdjacentHTML("beforeend",t)}changeForm(e){const{doctor:t,fullName:a,visitType:s,visitDescription:n,...r}=e;let o=`\n    <section class="modal">\n    <div class="modal__content">\n        <div class="modal__content__close-btn">&times;</div>\n        <h3 class="modal__content__title">Зміна візиту:</h3>  \n            <form class="modal-creating__form form flex__forma">           \n                <label for="fullName"class="visit__labels">Доктор:</label>\n                    <input name="doctor" type="text" value="${t}" class="border input--size">\n                <label for="fullName"class="visit__labels">ПІБ:</label>\n                     <input name="fullName" type="text" value="${a}" class="border input--size">\n               <label for="visitType" class="visit__labels">Тип візиту:</label>\n                     <input name="visitType" type="text" value="${s}" class="border input--size">\n                <label for="visitDescription" class="visit__labels">Опис:</label>\n                     <textarea cols="10" class="input--size" name="visitDescription" rows="5">${n}</textarea>\n                <label for="impotent" class="visit__labels">Статус:</label>\n                <select name="visitStatus" class="input--size">\n                    <option name="visitStatus" value="Вікрита">Вікрита</option>\n                    <option name="visitStatus" value="Закрита">Закрита</option>\n                </select>\n                <label for="impotent" class="visit__labels">Терміновість візиту:</label>\n                <select name="visitUrgency" class="input--size">\n                    <option value="Невідкладна">Невідкладна</option>\n                    <option value="Пріоритетна">Пріоритетна</option>\n                    <option value="Звичайна">Звичайна</option>                \n                 </select>\n            </form> \n            <button class="btn btn__rewrite" >Змінити</button>\n    </div>\n    </section>`;document.body.insertAdjacentHTML("afterbegin",o)}}class s extends a{constructor(e,t,a,s,n,r,o,i,c){super(e,t,a,s,c),this.bloodPressure=n,this.indexWeight=r,this.cardiovascularDisease=o,this.age=i}createFormСardiologist(e){super.createForma(e);let t=`\n        <div class="add__inputs Сardiologist">\n           <label class="visit__labels">${this.bloodPressure}:</label>\n                <input name="bloodPressure" type="text" class="border input--size">\n           <label class="visit__labels">${this.indexWeight}:</label>\n                <input name="bodyMassIndex" type="text" class="border input--size">\n           <label class="visit__labels">${this.cardiovascularDisease}:</label>\n                <input name="cardiovascularDisease" type="text" class="border input--size">\n           <label for="age"class="visit__labels">${this.age}:</label>\n                <input name="age"type="text" class="border input--size">\n       </div>\n        `;e.insertAdjacentHTML("beforeend",t)}changeForm(e,t){super.changeForm(e,t);let a=`\n           <<label class="visit__labels">:</label>\n           <input name="bloodPressure" value=${bloodPressure} type="text" class="border input--size">\n      <label class="visit__labels">:</label>\n           <input name="bodyMassIndex" value=${bodyMassIndex} type="text" class="border input--size">\n      <label class="visit__labels">:</label>\n           <input name="cardiovascularDisease" value=${cardiovascularDisease} type="text" class="border input--size">\n      <label for="age"class="visit__labels">:</label>\n           <input name="age"type="text" value=${age}class="border input--size">\n        `;e.insertAdjacentHTML("beforeend",a)}}class n extends a{constructor(e,t,a,s,n,r){super(e,t,a,s,r),this.visitDate=n}createFormDentist(e){super.createForma(e);let t=`\n        <div class="add__inputs Dentist">\n           <label for="visitDate" class="visit__labels">${this.visitDate}:</label>\n           <input type="date" name="visitDate" class="border input--size">\n       </div>\n        `;e.insertAdjacentHTML("beforeend",t)}changeForm(e){super.changeForm(e);const{visitDate:t}=e;let a=`\n           <label for="visitDate" class="visit__labels">Дата:</label>\n           <input type="date" name="visitDate" value=${t} class="border input--size">\n        `;document.querySelector(".form").insertAdjacentHTML("beforeend",a)}}class r extends a{constructor(e,t,a,s,n,r){super(e,t,a,s,r),this.visitAge=n}createFormTherapeutic(e){super.createForma(e);let t=`\n        <div class="add__inputs Therapeutic">\n           <label for="age" class="visit__labels">${this.visitAge}:</label>\n           <input type="text" name="age" class="border input--size">\n       </div>\n        `;e.insertAdjacentHTML("beforeend",t)}changeForm(e){super.changeForm(e);const{age:t}=e;let a=`\n        <label for="age"class="visit__labels">Вік:</label>\n        <input name="age" type="text" value=${t} class="border input--size"/>\n        `;document.querySelector(".form").insertAdjacentHTML("beforeend",a)}}const o=document.querySelector(".cards-filters__dropdown-condition"),i=document.querySelector(".cards-filters__dropdown-visits-term"),c=document.querySelector(".cards-filters__input-search"),l=document.querySelector(".cards-filters__btn-search");class d{constructor(e,t,a){this.searchInput=e,this.filterCards=[],this.array=t,this.btn=a}validationFilters(e,t,a){this.btn.addEventListener("click",(()=>{const s=a?this.filterCards:this.array;this.filterCards=s.filter((a=>{if("Усі"===e.value)return document.querySelectorAll(".board-of-cards__patient-card").forEach((e=>{if(e.classList.remove("board-of-cards__patient-card__hidden-filter-card"),e.dataset.id!==a.id)return e.classList.add("board-of-cards__patient-card__hidden-filter-card")})),this.filterCards;let s=a[t]!==e.value?"add":"remove";return document.querySelector(`[data-id="${a.id}"]`).classList[s]("board-of-cards__patient-card__hidden-filter-card"),"remove"==s}))}))}clickOnButtonSearch(){this.btn.addEventListener("click",(()=>{this.filterCards.forEach((e=>{if(document.querySelector(`[data-id="${e.id}"]`).classList.remove("board-of-cards__patient-card__hidden-filter-card"),!Object.values(e).some((e=>e.toString().toLowerCase().match(this.searchInput.value.toLowerCase()))))return document.querySelector(`[data-id="${e.id}"]`).classList.add("board-of-cards__patient-card__hidden-filter-card")}))}))}}const _=document.querySelector(".board-of-cards");class p{constructor(e,t,a,s,n,r){this.visitType=t,this.fullName=e,this.visitDescription=a,this.id=r,this.visitUrgency=n,this.status=s}renderingCard(){let e=`\n        <div class="board-of-cards__patient-card" data-doctor=${this.doctor} data-id=${this.id}>\n            <h2  class="board-of-cards__patient-card__title" >Картка візиту</h2>\n            <div  class="board-of-cards__patient-card__options" >\n              <p class="board-of-cards__patient-card__close-btn">&times;</p>\n              <p class="board-of-cards__patient-card__edit-btn" >&#10000;</p>\n            </div>\n            <div class="board-of-cards__patient-card__content">\n              <p class="board-of-cards__patient-card__property-name">Доктор:</p>\n              <p class="board-of-cards__patient-card__property-name"data-name="doctor">${this.doctor}</p>\n              <p class="board-of-cards__patient-card__property-name">ПІБ:</p>\n              <p class="board-of-cards__patient-card__property-name" data-name="fullName">${this.fullName}</p>\n            <button class="board-of-cards__patient-card__btn-details" data-btn="${this.id}">Детальніше</button>\n            <div class="board-of-cards__patient-card__more-details" data-detailsid="${this.id}">\n              <p class="board-of-cards__patient-card__property-name">Статус:</p>\n              <p class="board-of-cards__patient-card__property-name" data-name="visitStatus">${this.status}</p>\n              <p class="board-of-cards__patient-card__property-name">Терміновість візиту:</p>\n              <p class="board-of-cards__patient-card__property-name" data-name="visitUrgency">${this.visitUrgency}</p>\n              <p class="board-of-cards__patient-card__property-name">Тип візиту:</p>\n              <p class="board-of-cards__patient-card__property-name" data-name="visitType">${this.visitType}</p>\n              <p class="board-of-cards__patient-card__property-name">Опис:</p>\n              <p class="board-of-cards__patient-card__property-name" data-name="visitDescription">${this.visitDescription}</p>\n            </div>\n          </div>\n        </div>\n        `;_.insertAdjacentHTML("beforeend",e),g.classList.add("hidden")}hiddenDetails(e){e.addEventListener("click",(e=>{e.target.parentElement.dataset.id==e.target.dataset.id&&e.target.closest("div").querySelector(".board-of-cards__patient-card__more-details").classList.toggle("click-on-details")}))}deleteCard(e){e.addEventListener("click",(e=>{let t=e.target.closest("div").parentElement;if("board-of-cards__patient-card__close-btn"===e.target.className){let e=t.dataset.id;if(confirm("Ви дійсно хочити видалити картку?"))try{fetch(`https://ajax.test-danit.com/api/v2/cards/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${$}`}}).then((e=>{200===e.status&&(t.remove(),!_.contains(document.querySelector(".board-of-cards__patient-card"))&&g.classList.remove("hidden"))}))}catch(e){console.error(e)}}}))}}class u extends p{constructor(e,t,a,s,n,r,o,i,c,l,d){super(t,a,s,n,r,d),this.doctor=e,this.bloodPressure=o,this.bodyMassIndex=i,this.cardiovascularDisease=c,this.age=l}renderingCard(){super.renderingCard();let e=document.querySelector(`[data-btn="${this.id}"]`),t=`\n      <p class="board-of-cards__patient-card__property-name">Вік:</p>\n      <p class="board-of-cards__patient-card__property-name" data-name="age">${this.age}</p>\n      <p class="board-of-cards__patient-card__property-name">Тиск:</p>\n      <p class="board-of-cards__patient-card__property-name" data-name="bloodPressure">${this.bloodPressure}</p>\n      <p class="board-of-cards__patient-card__property-name">Індекс тіла:</p>\n      <p class="board-of-cards__patient-card__property-name" data-name="bodyMassIndex">${this.bodyMassIndex}</p>\n      <p class="board-of-cards__patient-card__property-name">Серцеві захворювання:</p>\n      <p class="board-of-cards__patient-card__property-name" data-name="cardiovascularDisease">${this.cardiovascularDisease}</p>\n \n  `;e.closest("div").querySelector(".board-of-cards__patient-card__more-details").insertAdjacentHTML("beforeend",t),super.hiddenDetails(e)}}class m extends p{constructor(e,t,a,s,n,r,o,i){super(t,a,s,n,r,i),this.doctor=e,this.visitDate=o}renderingCard(){super.renderingCard();let e=document.querySelector(`[data-btn="${this.id}"]`),t=`\n        <p class="board-of-cards__patient-card__property-name">Дата візиту:</p>\n        <p class="board-of-cards__patient-card__property-name" data-name="visitDate">${this.visitDate}</p>\n    `;e.closest("div").querySelector(".board-of-cards__patient-card__more-details").insertAdjacentHTML("beforeend",t),super.hiddenDetails(e)}}class b extends p{constructor(e,t,a,s,n,r,o,i){super(t,a,s,n,r,i),this.doctor=e,this.ageTherapist=o}renderingCard(){super.renderingCard();let e=document.querySelector(`[data-btn="${this.id}"]`),t=`\n          <p class="board-of-cards__patient-card__property-name">Вік:</p>\n          <p class="board-of-cards__patient-card__property-name"data-name="age">${this.ageTherapist}</p>\n      `;e.closest("div").querySelector(".board-of-cards__patient-card__more-details").insertAdjacentHTML("beforeend",t),super.hiddenDetails(e)}}function v(e){let t=new d(c,e,l);document.querySelector(".cards-filters").addEventListener("change",(()=>{t.validationFilters(o,"visitStatus",!1),t.validationFilters(i,"visitUrgency",!0),t.clickOnButtonSearch()})),(new p).deleteCard(_),e.forEach((e=>{const t=Object.values(e),[a]=t;let s;"Кардіолог"===a?s=new u(...t):"Стоматолог"===a?s=new m(...t):"Терапевт"===a&&(s=new b(...t)),s.renderingCard()}))}function h(e,t,a){Array.from(document.querySelector(`[data-id="${a}"]`).querySelector(`.${t}`).children).filter((e=>{if(e.hasAttribute("data-name"))return e})).forEach((t=>{e[t.dataset.name]=t.textContent}))}function f(e,t,a){const s=document.querySelector(`[data-id="${a}"]`),n=document.querySelector(".modal");document.querySelector(".btn__rewrite").addEventListener("click",(()=>{const r={};n.querySelectorAll("select,input,textarea").forEach((e=>{const{name:t}=e;r[t]=e.value})),fetch(`https://ajax.test-danit.com/api/v2/cards/${a}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(r)}).then((e=>{if(e.ok)return e.json()})).then((t=>{s.remove(),e.closeModal(),v([t])}))}))}document.querySelector(".board-of-cards").addEventListener("click",(e=>{let a=e.target.closest("div").parentElement.dataset.id;"board-of-cards__patient-card__edit-btn"===e.target.className&&e.target.closest("div").parentElement.dataset.id===a&&async function(e){const a={},o={};h(o,"board-of-cards__patient-card__content",e),h(a,"board-of-cards__patient-card__more-details",e);const i={...o,...a},{doctor:c}=i;let l=new t,d=new n(i),_=new r(i),p=new s(i);"Стоматолог"===c?(d.changeForm(i),f(l,$,e),l.clickCloseModal()):"Терапевт"===c?(_.changeForm(i),f(l,$,e),l.clickCloseModal()):"Кардіолог"===c&&(p.changeForm(i),l.clickCloseModal(),f(l,$,e))}(a)}));const y=document.querySelector(".header__btn-login"),g=document.querySelector(".board-of-cards__text");let S=new t;y.onclick=function(){S.createModalEnter("Прошу введіть дані:");const e=document.querySelector(".modal"),t=document.querySelector(".modal__content__close-btn");S.clickCloseModal(e,t),document.querySelector(".modal__content__registration-btn").addEventListener("click",(()=>{!async function(e,t){let a=await fetch("https://ajax.test-danit.com/api/v2/cards/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:`${e}`,password:`${t}`})});$=await a.text(),function(e){const t={token:`${e}`};localStorage.setItem("token",JSON.stringify(t))}($),L(JSON.parse(localStorage.getItem("token"))?.token)}(document.querySelector(".modal__email").value,document.querySelector(".modal__password").value),S.closeModal(),g.classList.add("hidden")}))};let $="";function L(e){e&&(M("header__btn"),M("cards-filters"),async function(e){let t=await fetch("https://ajax.test-danit.com/api/v2/cards",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}),a=await t.json();0!==a.length?(g.classList.add("hidden"),v(a)):g.classList.remove("hidden")}(e))}$=JSON.parse(localStorage.getItem("token"))?.token,window.onload=()=>{L($)};let q=new t("Кардіолог","Стоматолог","Терапевт"),x=new s("ПІБ","Мета візиту","Короткий опис візиту","Tерміновість","Звичайний тиск","Індекс маси тіла","Перенесені захворювання серцево-судинної системи","Вік","Статус візиту"),A=new n("ПІБ","Мета візиту","Короткий опис візиту","Tерміновість","Дата останнього відвідування","Статус візиту"),T=new r("ПІБ","Мета візиту","Короткий опис візиту","Tерміновість","Вік","Статус візиту");var w,D;document.querySelector(".header__btn-create-card").addEventListener("click",(e=>{e.preventDefault(),q.createModal(),q.clickCloseModal();const t=document.querySelector(".modal-creating__form"),a=document.querySelector(".modal__content__choose__doctor"),s={};function n(e,t,a){return s[e]=t.bind(a)}n("Кардіолог",x.createFormСardiologist,x),n("Стоматолог",A.createFormDentist,A),n("Терапевт",T.createFormTherapeutic,T),a.addEventListener("change",(()=>{t.innerHTML="",s[a.value](t),function(e,t){const a=document.querySelector(".modal");document.querySelector(".btn__send__visit").addEventListener("click",(()=>{const s={};a.querySelectorAll("select,input,textarea").forEach((e=>{const{name:t}=e;s[t]=e.value})),fetch("https://ajax.test-danit.com/api/v2/cards",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(s)}).then((e=>e.json())).then((e=>{t.closeModal(),v([e])}))}))}($,q)}))})),document.querySelector(".header__btn-exit").addEventListener("click",(()=>{g.classList.remove("hidden"),M("header__btn"),M("cards-filters"),localStorage.removeItem("token"),document.querySelectorAll(".board-of-cards__patient-card").forEach((e=>e.remove()))})),w=function(e){let t=!0===e?"webp":"no-webp";document.documentElement.classList.add(t)},(D=new Image).onload=D.onerror=function(){w(2==D.height)},D.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA";const M=e=>{document.querySelectorAll(`.${e}`).forEach((e=>e.classList.toggle("hidden")))}})();